<?xml version="1.0" encoding="UTF-8"?>
<metamorph xmlns="http://www.culturegraph.org/metamorph"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="1"
	entityMarker=".">
	<rules>
		<!-- http://sigel.staatsbibliothek-berlin.de/en/vergabe/adressenformat/092/ -->
		
		<!-- Use inr if available, use isil if not -->
		<choose>
			<data name="_id" source="008H.b" />
			<data name="_id" source="008H.e" />
		</choose>
		
		<data name="inr" source="008H.b" />
		<data name="isil" source="008H.e" />
		
		<!-- Different types of addresses -->
		<!-- Main address / address for visitors -->		
		<combine name="streetAddressVisitor" value="${strAdr}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "S" />
				</data>
			</if>
			<data source="032P.a" name="strAdr" />
		</combine>
		<combine name="localityVisitor" value="${loc}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "S" />
				</data>
			</if>
			<data source="032P.b" name="loc" />
		</combine>
		<combine name="countryVisitor" value="${cntr}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "S" />
				</data>
			</if>
			<data source="032P.d" name="cntr" />
		</combine>
		<combine name="postalCodeVisitor" value="${pstCd}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "S" />
				</data>
			</if>
			<data source="032P.e" name="pstCd" />
		</combine>
		<combine name="descriptionVisitor" value="${descr1} ${descr2}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "S" />
				</data>
			</if>	
			<data source="032P.3" name="descr1" />
			<data source="032P.z" name="descr2" />
		</combine>
		<combine name="openingHoursVisitor" value="${opening}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "S" />
				</data>
			</if>
			<data source="032P.i" name="opening" />
		</combine>
		<combine name="openingCommentVisitor" value="${comment}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "S" />
				</data>
			</if>
			<data source="032P.j" name="comment" />
		</combine>
		<combine name="latVisitor" value="${lat}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "S" />
				</data>
			</if>
			<data source="032P.k" name="lat" />
		</combine>
		<combine name="lonVisitor" value="${lon}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "S" />
				</data>
			</if>
			<data source="032P.l" name="lon" />
		</combine>
		
		<!-- Other address -->
		<combine name="streetAddressOther" value="${strAdr}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "W" />
				</data>
			</if>
			<data source="032P.a" name="strAdr" />
		</combine>
		<combine name="localityOther" value="${loc}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "W" />
				</data>
			</if>
			<data source="032P.b" name="loc" />
		</combine>
		<combine name="countryOther" value="${cntr}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "W" />
				</data>
			</if>
			<data source="032P.d" name="cntr" />
		</combine>
		<combine name="postalCodeOther" value="${pstCd}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "W" />
				</data>
			</if>
			<data source="032P.e" name="pstCd" />
		</combine>
		<combine name="descriptionOther" value="${descr1} ${descr2}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "W" />
				</data>
			</if>	
			<data source="032P.3" name="descr1" />
			<data source="032P.z" name="descr2" />
		</combine>
		<combine name="openingHoursOther" value="${opening}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "W" />
				</data>
			</if>
			<data source="032P.i" name="opening" />
		</combine>
		<combine name="openingCommentOther" value="${comment}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "W" />
				</data>
			</if>
			<data source="032P.j" name="comment" />
		</combine>
		<combine name="latOther" value="${lat}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "W" />
				</data>
			</if>
			<data source="032P.k" name="lat" />
		</combine>
		<combine name="lonOther" value="${lon}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "W" />
				</data>
			</if>
			<data source="032P.l" name="lon" />
		</combine>
		
		<!-- Mailing address -->
		<combine name="streetAddressMail" value="${strAdr}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "P" />
				</data>
			</if>
			<data source="032P.a" name="strAdr" />
		</combine>
		<combine name="postOfficeBoxNumber" value="${mlbx}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "P" />
				</data>
			</if>
			<data source="032P.g" name="mlbx" />
		</combine>
		<combine name="localityMail" value="${loc}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "P" />
				</data>
			</if>
			<data source="032P.b" name="loc" />
		</combine>
		<combine name="countryMail" value="${cntr}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "P" />
				</data>
			</if>
			<data source="032P.d" name="cntr" />
		</combine>
		<combine name="postalCodeMail" value="${pstCd}" sameEntity="true">
			<if>
				<data source="032P.2">
					<equals string = "P" />
				</data>
			</if>
			<data source="032P.e" name="pstCd" />
		</combine>
			
		<data source="_else"></data>
	</rules>
</metamorph>